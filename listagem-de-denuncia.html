<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="img/mega.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Página do Administrador</title>
    <link rel="stylesheet" href="styles.listagem.css">
</head>
<body>
    <div class="top-bar">
        <button onclick="voltar()" class="btn-voltar">Voltar</button>
        <button onclick="logoff()" class="btn-logoff">Sair</button>
    </div>
    <div class="container">
        <h2><strong>LISTAGEM DE DENÚNCIA</strong></h2>
        <ul class="responsive-table" id="table-container">
            <li class="table-header">
                <div class="col col-1">Nome</div>
                <div class="col col-2">Nº de Protocolo</div>
                <div class="col col-3">Denúncia</div>
                <div class="col col-4">Data da Denúncia</div>
                <div class="col col-5">Data da Ocorrência</div>
                <div class="col col-6"></div>
            </li>
        </ul>
    </div>

    <nav aria-label="...">
        <ul class="pagination justify-content-center">
            <!-- A paginação será preenchida dinamicamente -->
        </ul>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        const itemsPerPage = 5; // Número de itens por página
        let currentPage = 1;

        function displayPage(page) {
            currentPage = page;
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageItems = denuncias.slice(start, end);

            const tableContainer = document.getElementById("table-container");
            tableContainer.innerHTML = `
                <li class="table-header">
                    <div class="col col-1">Nome</div>
                    <div class="col col-2">Nº de Protocolo</div>
                    <div class="col col-3">Denúncia</div>
                    <div class="col col-4">Data da Denúncia</div>
                    <div class="col col-5">Data da Ocorrência</div>
                    <div class="col col-6"></div>
                </li>`;

            pageItems.forEach(item => {
                tableContainer.innerHTML += `
                    <li class="table-row">
                        <div class="col col-1">${item.nome}</div>
                        <div class="col col-2">${item.protocolo}</div>
                        <div class="col col-3">${item.denuncia}</div>
                        <div class="col col-4">${item.dataDenuncia}</div>
                        <div class="col col-5">${item.dataOcorrencia}</div>
                        <div class="col col-6"></div>
                    </li>`;
            });

            updatePagination();
        }

        function updatePagination() {
            const totalPages = Math.ceil(denuncias.length / itemsPerPage);
            const paginationContainer = document.querySelector(".pagination");
            paginationContainer.innerHTML = `
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" tabindex="-1" onclick="displayPage(${currentPage - 1})">Anterior</a>
                </li>`;

            for (let i = 1; i <= totalPages; i++) {
                paginationContainer.innerHTML += `
                    <li class="page-item ${currentPage === i ? 'active' : ''}" onclick="displayPage(${i})">
                        <a class="page-link" href="#">${i}</a>
                    </li>`;
            }

            paginationContainer.innerHTML += `
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="displayPage(${currentPage + 1})">Próximo</a>
                </li>`;
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            if (!localStorage.getItem('sessionToken')) {
                window.location.href = 'login.html';
            } else {
                displayPage(1);
            }
        });

        function logoff() {
            localStorage.removeItem('sessionToken');
            window.location.href = 'login.html';
        }

        function voltar() {
            window.history.back();
        }
    </script>
</body>
</html>
